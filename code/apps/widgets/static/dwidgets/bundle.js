var widgets=function(t){"use strict";function e(){}const n=t=>t;function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function l(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let s;function u(t,e){return s||(s=document.createElement("a")),s.href=e,t===s.href}const c="undefined"!=typeof window;let f=c?()=>window.performance.now():()=>Date.now(),d=c?t=>requestAnimationFrame(t):e;const p=new Set;function m(t){p.forEach((e=>{e.c(t)||(p.delete(e),e.f())})),0!==p.size&&d(m)}function h(t,e){t.appendChild(e)}function g(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function v(t){const e=x("style");return function(t,e){h(t.head||t,e)}(g(t),e),e}function y(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function x(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function _(){return w(" ")}function b(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function E(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function M(t,e){t.value=null==e?"":e}function S(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function P(t,e,n){t.classList[n?"add":"remove"](e)}const A=new Set;let O,R=0;function N(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),R-=i,R||d((()=>{R||(A.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),A.clear())})))}function L(t,r,i,o){if(!r)return e;const l=t.getBoundingClientRect();if(r.left===l.left&&r.right===l.right&&r.top===l.top&&r.bottom===l.bottom)return e;const{delay:a=0,duration:s=300,easing:u=n,start:c=f()+a,end:h=c+s,tick:y=e,css:$}=i(t,{from:r,to:l},o);let x,w=!0,_=!1;function b(){$&&N(t,x),w=!1}return function(t){let e;0===p.size&&d(m),new Promise((n=>{p.add(e={c:t,f:n})}))}((t=>{if(!_&&t>=c&&(_=!0),_&&t>=h&&(y(1,0),b()),!w)return!1;if(_){const e=0+1*u((t-c)/s);y(e,1-e)}return!0})),$&&(x=function(t,e,n,r,i,o,l,a=0){const s=16.666/r;let u="{\n";for(let t=0;t<=1;t+=s){const r=e+(n-e)*o(t);u+=100*t+`%{${l(r,1-r)}}\n`}const c=u+`100% {${l(n,1-n)}}\n}`,f=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(c)}_${a}`,d=g(t);A.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=v(t).sheet),m=d.__svelte_rules||(d.__svelte_rules={});m[f]||(m[f]=!0,p.insertRule(`@keyframes ${f} ${c}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?`${h}, `:""}${f} ${r}ms linear ${i}ms 1 both`,R+=1,f}(t,0,1,s,a,u,$)),a||(_=!0),y(0,1),b}function C(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,function(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}(t,i)}}function D(t){O=t}const j=[],q=[],J=[],T=[],B=Promise.resolve();let I=!1;function G(t){J.push(t)}let U=!1;const W=new Set;function z(){if(!U){U=!0;do{for(let t=0;t<j.length;t+=1){const e=j[t];D(e),F(e.$$)}for(D(null),j.length=0;q.length;)q.pop()();for(let t=0;t<J.length;t+=1){const e=J[t];W.has(e)||(W.add(e),e())}J.length=0}while(j.length);for(;T.length;)T.pop()();I=!1,U=!1,W.clear()}}function F(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}const X=new Set;function Y(t,e){t&&t.i&&(X.delete(t),t.i(e))}function H(t,e){t.f(),function(t,e){t.d(1),e.delete(t.key)}(t,e)}function K(t,e){-1===t.$$.dirty[0]&&(j.push(t),I||(I=!0,B.then(z)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(t,n,a,s,u,c,f,d=[-1]){const p=O;D(t);const m=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:u,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:n.context||[]),callbacks:i(),dirty:d,skip_bound:!1,root:n.target||p.$$.root};f&&f(m.root);let h=!1;if(m.ctx=a?a(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return m.ctx&&u(m.ctx[e],m.ctx[e]=i)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](i),h&&K(t,e)),n})):[],m.update(),h=!0,o(m.before_update),m.fragment=!!s&&s(m.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);m.fragment&&m.fragment.l(t),t.forEach($)}else m.fragment&&m.fragment.c();n.intro&&Y(t.$$.fragment),function(t,e,n,i){const{fragment:a,on_mount:s,on_destroy:u,after_update:c}=t.$$;a&&a.m(e,n),i||G((()=>{const e=s.map(r).filter(l);u?u.push(...e):o(e),t.$$.on_mount=[]})),c.forEach(G)}(t,n.target,n.anchor,n.customElement),z()}D(p)}class V{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Z(t){let e,n,r,i,l,a,s,c,f,d,p,m,g,v,M,P,A,O,R,N,L,C=t[2].x+"",D=t[2].y+"";return{c(){e=x("div"),n=w(C),r=w("% "),i=w(D),l=w("%"),a=_(),s=x("div"),c=x("div"),f=x("img"),m=_(),g=x("div"),M=_(),P=x("div"),k(f,"class",d=et+"-img"),u(f.src,p=t[7])||k(f,"src",p),k(f,"alt",""),k(g,"class",v=et+"-overlay"),k(P,"class",A=et+"-point"),S(P,"left",t[2].x+"%"),S(P,"top",t[2].y+"%"),k(c,"class",O=et+"-rect"),k(s,"class",R=et+"-preview"),S(s,"visibility",t[5]?"visible":"hidden")},m(o,u){y(o,e,u),h(e,n),h(e,r),h(e,i),h(e,l),y(o,a,u),y(o,s,u),h(s,c),h(c,f),t[15](f),h(c,m),h(c,g),h(c,M),h(c,P),t[16](c),N||(L=[b(f,"load",t[8]),b(f,"error",t[10]),b(g,"click",t[9])],N=!0)},p(t,e){4&e&&C!==(C=t[2].x+"")&&E(n,C),4&e&&D!==(D=t[2].y+"")&&E(i,D),128&e&&!u(f.src,p=t[7])&&k(f,"src",p),4&e&&S(P,"left",t[2].x+"%"),4&e&&S(P,"top",t[2].y+"%"),32&e&&S(s,"visibility",t[5]?"visible":"hidden")},d(n){n&&$(e),n&&$(a),n&&$(s),t[15](null),t[16](null),N=!1,o(L)}}}function tt(t){let n,r,i,l,a,s,u,c,f,d,p,m=t[1]&&Z(t);return{c(){n=x("div"),r=x("div"),i=x("input"),a=_(),s=x("input"),u=_(),m&&m.c(),c=_(),f=x("textarea"),k(i,"class",et+"-inp"),k(i,"type","text"),k(i,"id",l="id_"+t[0]),k(s,"class",et+"-btn"),k(s,"type","button"),s.value="არჩევა",k(r,"class",et),f.hidden=!0,k(f,"name",t[0]),f.value=t[6],k(n,"class",et+"-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,a),h(r,s),h(n,u),m&&m.m(n,null),h(n,c),h(n,f),d||(p=[b(i,"input",t[14]),b(s,"click",t[11])],d=!0)},p(t,[e]){1&e&&l!==(l="id_"+t[0])&&k(i,"id",l),2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?m?m.p(t,e):(m=Z(t),m.c(),m.m(n,c)):m&&(m.d(1),m=null),1&e&&k(f,"name",t[0]),64&e&&(f.value=t[6])},i:e,o:e,d(t){t&&$(n),m&&m.d(),d=!1,o(p)}}}let et="dynamic-image-widget";function nt(t,e,n){let r,i,o,{name:l}=e,{value:a}=e,{urlPrefix:s}=e,u=!1,c="",f="",d={x:50,y:50};a&&(c=a?.url||"",d.x=a?.point?.[0]||50,d.y=a?.point?.[1]||50);return t.$$set=t=>{"name"in t&&n(0,l=t.name),"value"in t&&n(12,a=t.value),"urlPrefix"in t&&n(13,s=t.urlPrefix)},t.$$.update=()=>{8194&t.$$.dirty&&n(7,r=c.startsWith("http")||c.startsWith("//")?c:s+c),6&t.$$.dirty&&n(6,f=c?JSON.stringify({url:c,point:[d.x,d.y]}):"null")},[l,c,d,i,o,u,f,r,()=>{n(5,u=!0),n(4,o.style.width=i.width+"px",o),n(4,o.style.height=i.height+"px",o)},t=>{const e=o.getBoundingClientRect();n(2,d.x=Math.floor(100*(t.clientX-e.left)/e.width),d),n(2,d.y=Math.floor(100*(t.clientY-e.top)/e.height),d)},()=>{n(5,u=!1)},()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1});e.callback=t=>{n(1,c=t.replace(s,"")),e.active=!1},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},a,s,function(){c=this.value,n(1,c)},function(t){q[t?"unshift":"push"]((()=>{i=t,n(3,i)}))},function(t){q[t?"unshift":"push"]((()=>{o=t,n(4,o)}))}]}class rt extends V{constructor(t){super(),Q(this,t,nt,tt,a,{name:0,value:12,urlPrefix:13})}}function it(t){let e,n,r,i,o=t[2]&&ot(t);return{c(){e=x("video"),r=_(),o&&o.c(),i=w(""),u(e.src,n=t[1])||k(e,"src",n),e.controls=!0,S(e,"max-width","300px"),S(e,"display","block"),S(e,"margin-top","10px")},m(t,n){y(t,e,n),y(t,r,n),o&&o.m(t,n),y(t,i,n)},p(t,r){2&r&&!u(e.src,n=t[1])&&k(e,"src",n),t[2]?o?o.p(t,r):(o=ot(t),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},d(t){t&&$(e),t&&$(r),o&&o.d(t),t&&$(i)}}}function ot(t){let e,n;return{c(){e=x("img"),u(e.src,n=t[2])||k(e,"src",n),k(e,"alt","Poster"),S(e,"max-width","150px"),S(e,"display","block"),S(e,"margin-top","5px")},m(t,n){y(t,e,n)},p(t,r){4&r&&!u(e.src,n=t[2])&&k(e,"src",n)},d(t){t&&$(e)}}}function lt(t){let n,r,i,l,a,s,u,c,f,d,p=t[1]&&it(t);return{c(){n=x("div"),r=x("div"),i=x("input"),l=_(),a=x("input"),s=_(),p&&p.c(),u=_(),c=x("textarea"),k(i,"type","text"),i.readOnly=!0,k(a,"type","button"),a.value="არჩევა",k(r,"class","dynamic-video-widget"),c.hidden=!0,k(c,"name",t[0]),c.value=t[3],k(n,"class","dynamic-video-widget-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,l),h(r,a),h(n,s),p&&p.m(n,null),h(n,u),h(n,c),f||(d=[b(i,"input",t[7]),b(a,"click",t[4])],f=!0)},p(t,[e]){2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?p?p.p(t,e):(p=it(t),p.c(),p.m(n,u)):p&&(p.d(1),p=null),1&e&&k(c,"name",t[0]),8&e&&(c.value=t[3])},i:e,o:e,d(t){t&&$(n),p&&p.d(),f=!1,o(d)}}}function at(t,e,n){let{name:r}=e,{value:i}=e,{urlPrefix:o="/media/uploads/videos/"}=e,l=i?.url||"",a=i?.poster||"",s="";return t.$$set=t=>{"name"in t&&n(0,r=t.name),"value"in t&&n(5,i=t.value),"urlPrefix"in t&&n(6,o=t.urlPrefix)},t.$$.update=()=>{6&t.$$.dirty&&n(3,s=l?JSON.stringify({url:l,poster:a||l.replace(/\.(mp4|webm|ogg)$/,".jpg")}):"null")},[r,l,a,s,()=>{const t=new MManager({media_manager_url:window.MEDIA_MANAGER_URL});t.callback=t=>{n(1,l=t),a||n(2,a=t.replace(/\.(mp4|webm|ogg)$/,".jpg"))},window.addEventListener("message",(e=>t.eventListener(e))),t.active=!0,t.open()},i,o,function(){l=this.value,n(1,l)}]}class st extends V{constructor(t){super(),Q(this,t,at,lt,a,{name:0,value:5,urlPrefix:6})}}class ut extends V{constructor(t){super(),Q(this,t,null,null,a,{})}}function ct(t){const e=t-1;return e*e*e+1}function ft(t,{from:e,to:n},r={}){const i=getComputedStyle(t),o="none"===i.transform?"":i.transform,[a,s]=i.transformOrigin.split(" ").map(parseFloat),u=e.left+e.width*a/n.width-(n.left+a),c=e.top+e.height*s/n.height-(n.top+s),{delay:f=0,duration:d=(t=>120*Math.sqrt(t)),easing:p=ct}=r;return{delay:f,duration:l(d)?d(Math.sqrt(u*u+c*c)):d,easing:p,css:(t,r)=>{const i=r*u,l=r*c,a=t+r*e.width/n.width,s=t+r*e.height/n.height;return`transform: ${o} translate(${i}px, ${l}px) scale(${a}, ${s});`}}}function dt(t,e,n){const r=t.slice();return r[16]=e[n],r[17]=e,r[18]=n,r}function pt(t,n){let r,i,l,a,s,c,f,d,p,m,g,v,E,S,A,O,R,N,D,j=e;function q(){return n[11](n[18])}function J(){n[12].call(A,n[17],n[18])}function T(...t){return n[13](n[18],...t)}function B(...t){return n[14](n[18],...t)}function I(){return n[15](n[18])}return{key:t,first:null,c(){r=x("div"),i=x("img"),s=_(),c=x("div"),f=_(),d=x("div"),p=x("button"),m=w("×"),g=_(),v=x("input"),S=_(),A=x("textarea"),O=_(),k(i,"class",ht+"-item-img"),u(i.src,l=n[4](n[16].url))||k(i,"src",l),k(i,"alt",a=n[16].title),k(i,"tabindex","-1"),k(c,"class",ht+"-item-overlay"),k(p,"title","წაშლა"),k(p,"type","button"),k(p,"class",ht+"-item-remove"),k(v,"type","text"),v.value=E=n[16].url,v.readOnly=!0,k(d,"class",ht+"-item-controls"),k(r,"class",ht+"-item"),k(r,"draggable","true"),k(r,"ondragover","return false"),P(r,"is-active",n[3]===n[18]),this.first=r},m(t,e){var o;y(t,r,e),h(r,i),h(r,s),h(r,c),h(r,f),h(r,d),h(d,p),h(p,m),h(d,g),h(d,v),h(d,S),h(d,A),M(A,n[16].title),h(r,O),N||(D=[b(p,"click",q),b(A,"input",J),b(r,"dragstart",T),b(r,"drop",(o=B,function(t){return t.preventDefault(),o.call(this,t)})),b(r,"dragenter",I)],N=!0)},p(t,e){n=t,2&e&&!u(i.src,l=n[4](n[16].url))&&k(i,"src",l),2&e&&a!==(a=n[16].title)&&k(i,"alt",a),2&e&&E!==(E=n[16].url)&&v.value!==E&&(v.value=E),2&e&&M(A,n[16].title),10&e&&P(r,"is-active",n[3]===n[18])},r(){R=r.getBoundingClientRect()},f(){C(r),j()},a(){j(),j=L(r,R,ft,{duration:500})},d(t){t&&$(r),N=!1,o(D)}}}function mt(t){let n,r,i,o,l,a,s,u,c,f=[],d=new Map,p=t[1];const m=t=>t[16].url;for(let e=0;e<p.length;e+=1){let n=dt(t,p,e),r=m(n);d.set(r,f[e]=pt(r,n))}return{c(){n=x("div"),r=x("div"),i=x("input"),o=_(),l=x("div");for(let t=0;t<f.length;t+=1)f[t].c();a=_(),s=x("textarea"),k(i,"class",ht+"-btn"),k(i,"type","button"),i.value="არჩევა",k(r,"class",ht+"-control"),k(l,"class",ht+"-items"),k(n,"class",ht+"-wrapper"),s.hidden=!0,k(s,"name",t[0]),s.value=t[2]},m(e,d){y(e,n,d),h(n,r),h(r,i),h(n,o),h(n,l);for(let t=0;t<f.length;t+=1)f[t].m(l,null);y(e,a,d),y(e,s,d),u||(c=b(i,"click",t[5]),u=!0)},p(t,[e]){if(474&e){p=t[1];for(let t=0;t<f.length;t+=1)f[t].r();f=function(t,e,n,r,i,o,l,a,s,u,c,f){let d=t.length,p=o.length,m=d;const h={};for(;m--;)h[t[m].key]=m;const g=[],v=new Map,y=new Map;for(m=p;m--;){const t=f(i,o,m),a=n(t);let s=l.get(a);s?r&&s.p(t,e):(s=u(a,t),s.c()),v.set(a,g[m]=s),a in h&&y.set(a,Math.abs(m-h[a]))}const $=new Set,x=new Set;function w(t){Y(t,1),t.m(a,c),l.set(t.key,t),c=t.first,p--}for(;d&&p;){const e=g[p-1],n=t[d-1],r=e.key,i=n.key;e===n?(c=e.first,d--,p--):v.has(i)?!l.has(r)||$.has(r)?w(e):x.has(i)?d--:y.get(r)>y.get(i)?(x.add(r),w(e)):($.add(i),d--):(s(n,l),d--)}for(;d--;){const e=t[d];v.has(e.key)||s(e,l)}for(;p;)w(g[p-1]);return g}(f,e,m,1,t,p,d,l,H,pt,null,dt);for(let t=0;t<f.length;t+=1)f[t].a()}1&e&&k(s,"name",t[0]),4&e&&(s.value=t[2])},i:e,o:e,d(t){t&&$(n);for(let t=0;t<f.length;t+=1)f[t].d();t&&$(a),t&&$(s),u=!1,c()}}}let ht="dynamic-gallery-widget";function gt(t,e,n){let{name:r}=e,{value:i}=e,{urlPrefix:o}=e,l=[],a="";i&&(l=i.map((t=>({...t}))));const s=t=>{const e=l;e.splice(t,1),n(1,l=e)};let u=!1;const c=(t,e)=>{t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move";const n=e;t.dataTransfer.setData("text/plain",n)},f=(t,e)=>{t.dataTransfer.dropEffect="move";const r=parseInt(t.dataTransfer.getData("text/plain")),i=l;r<e?(i.splice(e+1,0,i[r]),i.splice(r,1)):(i.splice(e,0,i[r]),i.splice(r+1,1)),n(1,l=i),n(3,u=null)};return t.$$set=t=>{"name"in t&&n(0,r=t.name),"value"in t&&n(9,i=t.value),"urlPrefix"in t&&n(10,o=t.urlPrefix)},t.$$.update=()=>{2&t.$$.dirty&&n(2,a=JSON.stringify(l.sort(((t,e)=>t<e?-1:1)).map((t=>({url:t.url,title:t.title})))))},[r,l,a,u,t=>t.startsWith("http")?t:"/media/"+t,()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1,autoclose:!1});e.callback=t=>{let e=t.replace(o,"");if(!!l.find((t=>t.url==e)))return;const r=l;r.splice(0,0,{url:e,title:""}),n(1,l=r)},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},s,c,f,i,o,t=>s(t),function(t,e){t[e].title=this.value,n(1,l)},(t,e)=>c(e,t),(t,e)=>f(e,t),t=>n(3,u=t)]}class vt extends V{constructor(t){super(),Q(this,t,gt,mt,a,{name:0,value:9,urlPrefix:10})}}const yt={image:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new rt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},video:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new st({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},audio:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new ut({target:t,props:{name:n,value:i}})},gallery:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new vt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})}};return document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("div[django_widget]").forEach((t=>{const e=t.getAttribute("django_widget");e in yt&&yt[e](t,{...t.dataset,parent:t})}))})),t.mapping=yt,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
