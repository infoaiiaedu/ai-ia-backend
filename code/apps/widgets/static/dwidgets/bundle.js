<<<<<<< HEAD
var widgets=function(t){"use strict";function e(){}const n=t=>t;function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function l(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let s;function u(t,e){return s||(s=document.createElement("a")),s.href=e,t===s.href}const c="undefined"!=typeof window;let f=c?()=>window.performance.now():()=>Date.now(),d=c?t=>requestAnimationFrame(t):e;const p=new Set;function m(t){p.forEach((e=>{e.c(t)||(p.delete(e),e.f())})),0!==p.size&&d(m)}function h(t,e){t.appendChild(e)}function g(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function v(t){const e=x("style");return function(t,e){h(t.head||t,e)}(g(t),e),e}function y(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function x(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function _(){return w(" ")}function b(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function k(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function E(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function M(t,e){t.value=null==e?"":e}function S(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function P(t,e,n){t.classList[n?"add":"remove"](e)}const A=new Set;let O,R=0;function N(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),R-=i,R||d((()=>{R||(A.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),A.clear())})))}function L(t,r,i,o){if(!r)return e;const l=t.getBoundingClientRect();if(r.left===l.left&&r.right===l.right&&r.top===l.top&&r.bottom===l.bottom)return e;const{delay:a=0,duration:s=300,easing:u=n,start:c=f()+a,end:h=c+s,tick:y=e,css:$}=i(t,{from:r,to:l},o);let x,w=!0,_=!1;function b(){$&&N(t,x),w=!1}return function(t){let e;0===p.size&&d(m),new Promise((n=>{p.add(e={c:t,f:n})}))}((t=>{if(!_&&t>=c&&(_=!0),_&&t>=h&&(y(1,0),b()),!w)return!1;if(_){const e=0+1*u((t-c)/s);y(e,1-e)}return!0})),$&&(x=function(t,e,n,r,i,o,l,a=0){const s=16.666/r;let u="{\n";for(let t=0;t<=1;t+=s){const r=e+(n-e)*o(t);u+=100*t+`%{${l(r,1-r)}}\n`}const c=u+`100% {${l(n,1-n)}}\n}`,f=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(c)}_${a}`,d=g(t);A.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=v(t).sheet),m=d.__svelte_rules||(d.__svelte_rules={});m[f]||(m[f]=!0,p.insertRule(`@keyframes ${f} ${c}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?`${h}, `:""}${f} ${r}ms linear ${i}ms 1 both`,R+=1,f}(t,0,1,s,a,u,$)),a||(_=!0),y(0,1),b}function C(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,function(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}(t,i)}}function D(t){O=t}const j=[],q=[],J=[],T=[],B=Promise.resolve();let I=!1;function G(t){J.push(t)}let U=!1;const W=new Set;function z(){if(!U){U=!0;do{for(let t=0;t<j.length;t+=1){const e=j[t];D(e),F(e.$$)}for(D(null),j.length=0;q.length;)q.pop()();for(let t=0;t<J.length;t+=1){const e=J[t];W.has(e)||(W.add(e),e())}J.length=0}while(j.length);for(;T.length;)T.pop()();I=!1,U=!1,W.clear()}}function F(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}const X=new Set;function Y(t,e){t&&t.i&&(X.delete(t),t.i(e))}function H(t,e){t.f(),function(t,e){t.d(1),e.delete(t.key)}(t,e)}function K(t,e){-1===t.$$.dirty[0]&&(j.push(t),I||(I=!0,B.then(z)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Q(t,n,a,s,u,c,f,d=[-1]){const p=O;D(t);const m=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:u,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:n.context||[]),callbacks:i(),dirty:d,skip_bound:!1,root:n.target||p.$$.root};f&&f(m.root);let h=!1;if(m.ctx=a?a(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return m.ctx&&u(m.ctx[e],m.ctx[e]=i)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](i),h&&K(t,e)),n})):[],m.update(),h=!0,o(m.before_update),m.fragment=!!s&&s(m.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);m.fragment&&m.fragment.l(t),t.forEach($)}else m.fragment&&m.fragment.c();n.intro&&Y(t.$$.fragment),function(t,e,n,i){const{fragment:a,on_mount:s,on_destroy:u,after_update:c}=t.$$;a&&a.m(e,n),i||G((()=>{const e=s.map(r).filter(l);u?u.push(...e):o(e),t.$$.on_mount=[]})),c.forEach(G)}(t,n.target,n.anchor,n.customElement),z()}D(p)}class V{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Z(t){let e,n,r,i,l,a,s,c,f,d,p,m,g,v,M,P,A,O,R,N,L,C=t[2].x+"",D=t[2].y+"";return{c(){e=x("div"),n=w(C),r=w("% "),i=w(D),l=w("%"),a=_(),s=x("div"),c=x("div"),f=x("img"),m=_(),g=x("div"),M=_(),P=x("div"),k(f,"class",d=et+"-img"),u(f.src,p=t[7])||k(f,"src",p),k(f,"alt",""),k(g,"class",v=et+"-overlay"),k(P,"class",A=et+"-point"),S(P,"left",t[2].x+"%"),S(P,"top",t[2].y+"%"),k(c,"class",O=et+"-rect"),k(s,"class",R=et+"-preview"),S(s,"visibility",t[5]?"visible":"hidden")},m(o,u){y(o,e,u),h(e,n),h(e,r),h(e,i),h(e,l),y(o,a,u),y(o,s,u),h(s,c),h(c,f),t[15](f),h(c,m),h(c,g),h(c,M),h(c,P),t[16](c),N||(L=[b(f,"load",t[8]),b(f,"error",t[10]),b(g,"click",t[9])],N=!0)},p(t,e){4&e&&C!==(C=t[2].x+"")&&E(n,C),4&e&&D!==(D=t[2].y+"")&&E(i,D),128&e&&!u(f.src,p=t[7])&&k(f,"src",p),4&e&&S(P,"left",t[2].x+"%"),4&e&&S(P,"top",t[2].y+"%"),32&e&&S(s,"visibility",t[5]?"visible":"hidden")},d(n){n&&$(e),n&&$(a),n&&$(s),t[15](null),t[16](null),N=!1,o(L)}}}function tt(t){let n,r,i,l,a,s,u,c,f,d,p,m=t[1]&&Z(t);return{c(){n=x("div"),r=x("div"),i=x("input"),a=_(),s=x("input"),u=_(),m&&m.c(),c=_(),f=x("textarea"),k(i,"class",et+"-inp"),k(i,"type","text"),k(i,"id",l="id_"+t[0]),k(s,"class",et+"-btn"),k(s,"type","button"),s.value="არჩევა",k(r,"class",et),f.hidden=!0,k(f,"name",t[0]),f.value=t[6],k(n,"class",et+"-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,a),h(r,s),h(n,u),m&&m.m(n,null),h(n,c),h(n,f),d||(p=[b(i,"input",t[14]),b(s,"click",t[11])],d=!0)},p(t,[e]){1&e&&l!==(l="id_"+t[0])&&k(i,"id",l),2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?m?m.p(t,e):(m=Z(t),m.c(),m.m(n,c)):m&&(m.d(1),m=null),1&e&&k(f,"name",t[0]),64&e&&(f.value=t[6])},i:e,o:e,d(t){t&&$(n),m&&m.d(),d=!1,o(p)}}}let et="dynamic-image-widget";function nt(t,e,n){let r,i,o,{name:l}=e,{value:a}=e,{urlPrefix:s}=e,u=!1,c="",f="",d={x:50,y:50};a&&(c=a?.url||"",d.x=a?.point?.[0]||50,d.y=a?.point?.[1]||50);return t.$$set=t=>{"name"in t&&n(0,l=t.name),"value"in t&&n(12,a=t.value),"urlPrefix"in t&&n(13,s=t.urlPrefix)},t.$$.update=()=>{8194&t.$$.dirty&&n(7,r=c.startsWith("http")||c.startsWith("//")?c:s+c),6&t.$$.dirty&&n(6,f=c?JSON.stringify({url:c,point:[d.x,d.y]}):"null")},[l,c,d,i,o,u,f,r,()=>{n(5,u=!0),n(4,o.style.width=i.width+"px",o),n(4,o.style.height=i.height+"px",o)},t=>{const e=o.getBoundingClientRect();n(2,d.x=Math.floor(100*(t.clientX-e.left)/e.width),d),n(2,d.y=Math.floor(100*(t.clientY-e.top)/e.height),d)},()=>{n(5,u=!1)},()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1});e.callback=t=>{n(1,c=t.replace(s,"")),e.active=!1},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},a,s,function(){c=this.value,n(1,c)},function(t){q[t?"unshift":"push"]((()=>{i=t,n(3,i)}))},function(t){q[t?"unshift":"push"]((()=>{o=t,n(4,o)}))}]}class rt extends V{constructor(t){super(),Q(this,t,nt,tt,a,{name:0,value:12,urlPrefix:13})}}function it(t){let e,n,r,i,o=t[2]&&ot(t);return{c(){e=x("video"),r=_(),o&&o.c(),i=w(""),u(e.src,n=t[1])||k(e,"src",n),e.controls=!0,S(e,"max-width","300px"),S(e,"display","block"),S(e,"margin-top","10px")},m(t,n){y(t,e,n),y(t,r,n),o&&o.m(t,n),y(t,i,n)},p(t,r){2&r&&!u(e.src,n=t[1])&&k(e,"src",n),t[2]?o?o.p(t,r):(o=ot(t),o.c(),o.m(i.parentNode,i)):o&&(o.d(1),o=null)},d(t){t&&$(e),t&&$(r),o&&o.d(t),t&&$(i)}}}function ot(t){let e,n;return{c(){e=x("img"),u(e.src,n=t[2])||k(e,"src",n),k(e,"alt","Poster"),S(e,"max-width","150px"),S(e,"display","block"),S(e,"margin-top","5px")},m(t,n){y(t,e,n)},p(t,r){4&r&&!u(e.src,n=t[2])&&k(e,"src",n)},d(t){t&&$(e)}}}function lt(t){let n,r,i,l,a,s,u,c,f,d,p=t[1]&&it(t);return{c(){n=x("div"),r=x("div"),i=x("input"),l=_(),a=x("input"),s=_(),p&&p.c(),u=_(),c=x("textarea"),k(i,"type","text"),i.readOnly=!0,k(a,"type","button"),a.value="არჩევა",k(r,"class","dynamic-video-widget"),c.hidden=!0,k(c,"name",t[0]),c.value=t[3],k(n,"class","dynamic-video-widget-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,l),h(r,a),h(n,s),p&&p.m(n,null),h(n,u),h(n,c),f||(d=[b(i,"input",t[7]),b(a,"click",t[4])],f=!0)},p(t,[e]){2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?p?p.p(t,e):(p=it(t),p.c(),p.m(n,u)):p&&(p.d(1),p=null),1&e&&k(c,"name",t[0]),8&e&&(c.value=t[3])},i:e,o:e,d(t){t&&$(n),p&&p.d(),f=!1,o(d)}}}function at(t,e,n){let{name:r}=e,{value:i}=e,{urlPrefix:o="/media/uploads/videos/"}=e,l=i?.url||"",a=i?.poster||"",s="";return t.$$set=t=>{"name"in t&&n(0,r=t.name),"value"in t&&n(5,i=t.value),"urlPrefix"in t&&n(6,o=t.urlPrefix)},t.$$.update=()=>{6&t.$$.dirty&&n(3,s=l?JSON.stringify({url:l,poster:a||l.replace(/\.(mp4|webm|ogg)$/,".jpg")}):"null")},[r,l,a,s,()=>{const t=new MManager({media_manager_url:window.MEDIA_MANAGER_URL});t.callback=t=>{n(1,l=t),a||n(2,a=t.replace(/\.(mp4|webm|ogg)$/,".jpg"))},window.addEventListener("message",(e=>t.eventListener(e))),t.active=!0,t.open()},i,o,function(){l=this.value,n(1,l)}]}class st extends V{constructor(t){super(),Q(this,t,at,lt,a,{name:0,value:5,urlPrefix:6})}}class ut extends V{constructor(t){super(),Q(this,t,null,null,a,{})}}function ct(t){const e=t-1;return e*e*e+1}function ft(t,{from:e,to:n},r={}){const i=getComputedStyle(t),o="none"===i.transform?"":i.transform,[a,s]=i.transformOrigin.split(" ").map(parseFloat),u=e.left+e.width*a/n.width-(n.left+a),c=e.top+e.height*s/n.height-(n.top+s),{delay:f=0,duration:d=(t=>120*Math.sqrt(t)),easing:p=ct}=r;return{delay:f,duration:l(d)?d(Math.sqrt(u*u+c*c)):d,easing:p,css:(t,r)=>{const i=r*u,l=r*c,a=t+r*e.width/n.width,s=t+r*e.height/n.height;return`transform: ${o} translate(${i}px, ${l}px) scale(${a}, ${s});`}}}function dt(t,e,n){const r=t.slice();return r[16]=e[n],r[17]=e,r[18]=n,r}function pt(t,n){let r,i,l,a,s,c,f,d,p,m,g,v,E,S,A,O,R,N,D,j=e;function q(){return n[11](n[18])}function J(){n[12].call(A,n[17],n[18])}function T(...t){return n[13](n[18],...t)}function B(...t){return n[14](n[18],...t)}function I(){return n[15](n[18])}return{key:t,first:null,c(){r=x("div"),i=x("img"),s=_(),c=x("div"),f=_(),d=x("div"),p=x("button"),m=w("×"),g=_(),v=x("input"),S=_(),A=x("textarea"),O=_(),k(i,"class",ht+"-item-img"),u(i.src,l=n[4](n[16].url))||k(i,"src",l),k(i,"alt",a=n[16].title),k(i,"tabindex","-1"),k(c,"class",ht+"-item-overlay"),k(p,"title","წაშლა"),k(p,"type","button"),k(p,"class",ht+"-item-remove"),k(v,"type","text"),v.value=E=n[16].url,v.readOnly=!0,k(d,"class",ht+"-item-controls"),k(r,"class",ht+"-item"),k(r,"draggable","true"),k(r,"ondragover","return false"),P(r,"is-active",n[3]===n[18]),this.first=r},m(t,e){var o;y(t,r,e),h(r,i),h(r,s),h(r,c),h(r,f),h(r,d),h(d,p),h(p,m),h(d,g),h(d,v),h(d,S),h(d,A),M(A,n[16].title),h(r,O),N||(D=[b(p,"click",q),b(A,"input",J),b(r,"dragstart",T),b(r,"drop",(o=B,function(t){return t.preventDefault(),o.call(this,t)})),b(r,"dragenter",I)],N=!0)},p(t,e){n=t,2&e&&!u(i.src,l=n[4](n[16].url))&&k(i,"src",l),2&e&&a!==(a=n[16].title)&&k(i,"alt",a),2&e&&E!==(E=n[16].url)&&v.value!==E&&(v.value=E),2&e&&M(A,n[16].title),10&e&&P(r,"is-active",n[3]===n[18])},r(){R=r.getBoundingClientRect()},f(){C(r),j()},a(){j(),j=L(r,R,ft,{duration:500})},d(t){t&&$(r),N=!1,o(D)}}}function mt(t){let n,r,i,o,l,a,s,u,c,f=[],d=new Map,p=t[1];const m=t=>t[16].url;for(let e=0;e<p.length;e+=1){let n=dt(t,p,e),r=m(n);d.set(r,f[e]=pt(r,n))}return{c(){n=x("div"),r=x("div"),i=x("input"),o=_(),l=x("div");for(let t=0;t<f.length;t+=1)f[t].c();a=_(),s=x("textarea"),k(i,"class",ht+"-btn"),k(i,"type","button"),i.value="არჩევა",k(r,"class",ht+"-control"),k(l,"class",ht+"-items"),k(n,"class",ht+"-wrapper"),s.hidden=!0,k(s,"name",t[0]),s.value=t[2]},m(e,d){y(e,n,d),h(n,r),h(r,i),h(n,o),h(n,l);for(let t=0;t<f.length;t+=1)f[t].m(l,null);y(e,a,d),y(e,s,d),u||(c=b(i,"click",t[5]),u=!0)},p(t,[e]){if(474&e){p=t[1];for(let t=0;t<f.length;t+=1)f[t].r();f=function(t,e,n,r,i,o,l,a,s,u,c,f){let d=t.length,p=o.length,m=d;const h={};for(;m--;)h[t[m].key]=m;const g=[],v=new Map,y=new Map;for(m=p;m--;){const t=f(i,o,m),a=n(t);let s=l.get(a);s?r&&s.p(t,e):(s=u(a,t),s.c()),v.set(a,g[m]=s),a in h&&y.set(a,Math.abs(m-h[a]))}const $=new Set,x=new Set;function w(t){Y(t,1),t.m(a,c),l.set(t.key,t),c=t.first,p--}for(;d&&p;){const e=g[p-1],n=t[d-1],r=e.key,i=n.key;e===n?(c=e.first,d--,p--):v.has(i)?!l.has(r)||$.has(r)?w(e):x.has(i)?d--:y.get(r)>y.get(i)?(x.add(r),w(e)):($.add(i),d--):(s(n,l),d--)}for(;d--;){const e=t[d];v.has(e.key)||s(e,l)}for(;p;)w(g[p-1]);return g}(f,e,m,1,t,p,d,l,H,pt,null,dt);for(let t=0;t<f.length;t+=1)f[t].a()}1&e&&k(s,"name",t[0]),4&e&&(s.value=t[2])},i:e,o:e,d(t){t&&$(n);for(let t=0;t<f.length;t+=1)f[t].d();t&&$(a),t&&$(s),u=!1,c()}}}let ht="dynamic-gallery-widget";function gt(t,e,n){let{name:r}=e,{value:i}=e,{urlPrefix:o}=e,l=[],a="";i&&(l=i.map((t=>({...t}))));const s=t=>{const e=l;e.splice(t,1),n(1,l=e)};let u=!1;const c=(t,e)=>{t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move";const n=e;t.dataTransfer.setData("text/plain",n)},f=(t,e)=>{t.dataTransfer.dropEffect="move";const r=parseInt(t.dataTransfer.getData("text/plain")),i=l;r<e?(i.splice(e+1,0,i[r]),i.splice(r,1)):(i.splice(e,0,i[r]),i.splice(r+1,1)),n(1,l=i),n(3,u=null)};return t.$$set=t=>{"name"in t&&n(0,r=t.name),"value"in t&&n(9,i=t.value),"urlPrefix"in t&&n(10,o=t.urlPrefix)},t.$$.update=()=>{2&t.$$.dirty&&n(2,a=JSON.stringify(l.sort(((t,e)=>t<e?-1:1)).map((t=>({url:t.url,title:t.title})))))},[r,l,a,u,t=>t.startsWith("http")?t:"/media/"+t,()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1,autoclose:!1});e.callback=t=>{let e=t.replace(o,"");if(!!l.find((t=>t.url==e)))return;const r=l;r.splice(0,0,{url:e,title:""}),n(1,l=r)},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},s,c,f,i,o,t=>s(t),function(t,e){t[e].title=this.value,n(1,l)},(t,e)=>c(e,t),(t,e)=>f(e,t),t=>n(3,u=t)]}class vt extends V{constructor(t){super(),Q(this,t,gt,mt,a,{name:0,value:9,urlPrefix:10})}}const yt={image:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new rt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},video:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new st({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},audio:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new ut({target:t,props:{name:n,value:i}})},gallery:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new vt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})}};return document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("div[django_widget]").forEach((t=>{const e=t.getAttribute("django_widget");e in yt&&yt[e](t,{...t.dataset,parent:t})}))})),t.mapping=yt,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
=======
var widgets=function(t){"use strict";function e(){}const n=t=>t;function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function l(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let u;function s(t,e){return u||(u=document.createElement("a")),u.href=e,t===u.href}const c="undefined"!=typeof window;let d=c?()=>window.performance.now():()=>Date.now(),f=c?t=>requestAnimationFrame(t):e;const p=new Set;function m(t){p.forEach((e=>{e.c(t)||(p.delete(e),e.f())})),0!==p.size&&f(m)}function h(t,e){t.appendChild(e)}function v(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function g(t){const e=_("style");return function(t,e){h(t.head||t,e)}(v(t),e),e}function y(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function _(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function x(){return w(" ")}function b(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function E(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function M(t,e){t.value=null==e?"":e}function S(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function A(t,e,n){t.classList[n?"add":"remove"](e)}const R=new Set;let N,O=0;function L(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),O-=i,O||f((()=>{O||(R.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),R.clear())})))}function P(t,r,i,o){if(!r)return e;const l=t.getBoundingClientRect();if(r.left===l.left&&r.right===l.right&&r.top===l.top&&r.bottom===l.bottom)return e;const{delay:a=0,duration:u=300,easing:s=n,start:c=d()+a,end:h=c+u,tick:y=e,css:$}=i(t,{from:r,to:l},o);let _,w=!0,x=!1;function b(){$&&L(t,_),w=!1}return function(t){let e;0===p.size&&f(m),new Promise((n=>{p.add(e={c:t,f:n})}))}((t=>{if(!x&&t>=c&&(x=!0),x&&t>=h&&(y(1,0),b()),!w)return!1;if(x){const e=0+1*s((t-c)/u);y(e,1-e)}return!0})),$&&(_=function(t,e,n,r,i,o,l,a=0){const u=16.666/r;let s="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);s+=100*t+`%{${l(r,1-r)}}\n`}const c=s+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(c)}_${a}`,f=v(t);R.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=g(t).sheet),m=f.__svelte_rules||(f.__svelte_rules={});m[d]||(m[d]=!0,p.insertRule(`@keyframes ${d} ${c}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?`${h}, `:""}${d} ${r}ms linear ${i}ms 1 both`,O+=1,d}(t,0,1,u,a,s,$)),a||(x=!0),y(0,1),b}function D(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,function(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}(t,i)}}function q(t){N=t}const C=[],j=[],T=[],I=[],J=Promise.resolve();let G=!1;function B(t){T.push(t)}let V=!1;const U=new Set;function W(){if(!V){V=!0;do{for(let t=0;t<C.length;t+=1){const e=C[t];q(e),F(e.$$)}for(q(null),C.length=0;j.length;)j.pop()();for(let t=0;t<T.length;t+=1){const e=T[t];U.has(e)||(U.add(e),e())}T.length=0}while(C.length);for(;I.length;)I.pop()();G=!1,V=!1,U.clear()}}function F(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const Y=new Set;function z(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function K(t,e){t.f(),function(t,e){t.d(1),e.delete(t.key)}(t,e)}function X(t,e){-1===t.$$.dirty[0]&&(C.push(t),G||(G=!0,J.then(W)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(t,n,a,u,s,c,d,f=[-1]){const p=N;q(t);const m=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:n.context||[]),callbacks:i(),dirty:f,skip_bound:!1,root:n.target||p.$$.root};d&&d(m.root);let h=!1;if(m.ctx=a?a(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return m.ctx&&s(m.ctx[e],m.ctx[e]=i)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](i),h&&X(t,e)),n})):[],m.update(),h=!0,o(m.before_update),m.fragment=!!u&&u(m.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);m.fragment&&m.fragment.l(t),t.forEach($)}else m.fragment&&m.fragment.c();n.intro&&z(t.$$.fragment),function(t,e,n,i){const{fragment:a,on_mount:u,on_destroy:s,after_update:c}=t.$$;a&&a.m(e,n),i||B((()=>{const e=u.map(r).filter(l);s?s.push(...e):o(e),t.$$.on_mount=[]})),c.forEach(B)}(t,n.target,n.anchor,n.customElement),W()}q(p)}class Q{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Z(t){let e,n,r,i,l,a,u,c,d,f,p,m,v,g,M,A,R,N,O,L,P,D=t[2].x+"",q=t[2].y+"";return{c(){e=_("div"),n=w(D),r=w("% "),i=w(q),l=w("%"),a=x(),u=_("div"),c=_("div"),d=_("img"),m=x(),v=_("div"),M=x(),A=_("div"),E(d,"class",f=et+"-img"),s(d.src,p=t[7])||E(d,"src",p),E(d,"alt",""),E(v,"class",g=et+"-overlay"),E(A,"class",R=et+"-point"),S(A,"left",t[2].x+"%"),S(A,"top",t[2].y+"%"),E(c,"class",N=et+"-rect"),E(u,"class",O=et+"-preview"),S(u,"visibility",t[5]?"visible":"hidden")},m(o,s){y(o,e,s),h(e,n),h(e,r),h(e,i),h(e,l),y(o,a,s),y(o,u,s),h(u,c),h(c,d),t[15](d),h(c,m),h(c,v),h(c,M),h(c,A),t[16](c),L||(P=[b(d,"load",t[8]),b(d,"error",t[10]),b(v,"click",t[9])],L=!0)},p(t,e){4&e&&D!==(D=t[2].x+"")&&k(n,D),4&e&&q!==(q=t[2].y+"")&&k(i,q),128&e&&!s(d.src,p=t[7])&&E(d,"src",p),4&e&&S(A,"left",t[2].x+"%"),4&e&&S(A,"top",t[2].y+"%"),32&e&&S(u,"visibility",t[5]?"visible":"hidden")},d(n){n&&$(e),n&&$(a),n&&$(u),t[15](null),t[16](null),L=!1,o(P)}}}function tt(t){let n,r,i,l,a,u,s,c,d,f,p,m=t[1]&&Z(t);return{c(){n=_("div"),r=_("div"),i=_("input"),a=x(),u=_("input"),s=x(),m&&m.c(),c=x(),d=_("textarea"),E(i,"class",et+"-inp"),E(i,"type","text"),E(i,"id",l="id_"+t[0]),E(u,"class",et+"-btn"),E(u,"type","button"),u.value="არჩევა",E(r,"class",et),d.hidden=!0,E(d,"name",t[0]),d.value=t[6],E(n,"class",et+"-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,a),h(r,u),h(n,s),m&&m.m(n,null),h(n,c),h(n,d),f||(p=[b(i,"input",t[14]),b(u,"click",t[11])],f=!0)},p(t,[e]){1&e&&l!==(l="id_"+t[0])&&E(i,"id",l),2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?m?m.p(t,e):(m=Z(t),m.c(),m.m(n,c)):m&&(m.d(1),m=null),1&e&&E(d,"name",t[0]),64&e&&(d.value=t[6])},i:e,o:e,d(t){t&&$(n),m&&m.d(),f=!1,o(p)}}}let et="dynamic-image-widget";function nt(t,e,n){let r,i,o,{name:l}=e,{value:a}=e,{urlPrefix:u}=e,s=!1,c="",d="",f={x:50,y:50};a&&(c=a?.url||"",f.x=a?.point?.[0]||50,f.y=a?.point?.[1]||50);return t.$$set=t=>{"name"in t&&n(0,l=t.name),"value"in t&&n(12,a=t.value),"urlPrefix"in t&&n(13,u=t.urlPrefix)},t.$$.update=()=>{8194&t.$$.dirty&&n(7,r=c.startsWith("http")||c.startsWith("//")?c:u+c),6&t.$$.dirty&&n(6,d=c?JSON.stringify({url:c,point:[f.x,f.y]}):"null")},[l,c,f,i,o,s,d,r,()=>{n(5,s=!0),n(4,o.style.width=i.width+"px",o),n(4,o.style.height=i.height+"px",o)},t=>{const e=o.getBoundingClientRect();n(2,f.x=Math.floor(100*(t.clientX-e.left)/e.width),f),n(2,f.y=Math.floor(100*(t.clientY-e.top)/e.height),f)},()=>{n(5,s=!1)},()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1});e.callback=t=>{n(1,c=t.replace(u,"")),e.active=!1},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},a,u,function(){c=this.value,n(1,c)},function(t){j[t?"unshift":"push"]((()=>{i=t,n(3,i)}))},function(t){j[t?"unshift":"push"]((()=>{o=t,n(4,o)}))}]}class rt extends Q{constructor(t){super(),H(this,t,nt,tt,a,{name:0,value:12,urlPrefix:13})}}function it(t){let e,n,r,i,o,l=t[1]&&ot(t);return{c(){e=_("div"),n=_("video"),i=x(),l&&l.c(),s(n.src,r=t[2])||E(n,"src",r),n.controls=!0,E(e,"class",o=at+"-container")},m(r,o){y(r,e,o),h(e,n),t[17](n),h(e,i),l&&l.m(e,null)},p(t,i){4&i&&!s(n.src,r=t[2])&&E(n,"src",r),t[1]?l?l.p(t,i):(l=ot(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(n){n&&$(e),t[17](null),l&&l.d()}}}function ot(t){let e,n,r,i;return{c(){e=_("img"),s(e.src,n=t[8])||E(e,"src",n)},m(n,o){y(n,e,o),t[18](e),r||(i=b(e,"error",t[9]),r=!0)},p(t,r){256&r&&!s(e.src,n=t[8])&&E(e,"src",n)},d(n){n&&$(e),t[18](null),r=!1,i()}}}function lt(t){let n,r,i,l,a,u,s,c,d,f,p,m,v,g,w,k,S,A,R,N=t[2]&&it(t);return{c(){n=_("div"),r=_("div"),i=_("input"),a=x(),u=_("input"),s=x(),c=_("input"),d=x(),f=_("input"),p=x(),m=_("input"),w=x(),N&&N.c(),k=x(),S=_("textarea"),E(i,"class",at+"-inp"),E(i,"type","text"),E(i,"id",l="id_"+t[0]),E(u,"class",at+"-btn"),E(u,"type","button"),u.value="არჩევა",E(c,"class",at+"-btn"),E(c,"type","button"),c.value="მოჭრა",c.disabled=t[7],E(f,"class",at+"-btn"),E(f,"type","button"),f.value="სურათი",E(r,"class",at),m.hidden=v=!t[2],E(m,"class",at+"-inp poster"),E(m,"type","text"),E(m,"id",g="id_"+t[0]),S.hidden=!0,E(S,"name",t[0]),S.value=t[6],E(n,"class",at+"-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[2]),h(r,a),h(r,u),h(r,s),h(r,c),h(r,d),h(r,f),h(n,p),h(n,m),M(m,t[1]),h(n,w),N&&N.m(n,null),h(n,k),h(n,S),t[19](n),A||(R=[b(i,"input",t[15]),b(u,"click",t[11]),b(c,"click",t[12]),b(f,"click",t[10]),b(m,"input",t[16])],A=!0)},p(t,[e]){1&e&&l!==(l="id_"+t[0])&&E(i,"id",l),4&e&&i.value!==t[2]&&M(i,t[2]),128&e&&(c.disabled=t[7]),4&e&&v!==(v=!t[2])&&(m.hidden=v),1&e&&g!==(g="id_"+t[0])&&E(m,"id",g),2&e&&m.value!==t[1]&&M(m,t[1]),t[2]?N?N.p(t,e):(N=it(t),N.c(),N.m(n,k)):N&&(N.d(1),N=null),1&e&&E(S,"name",t[0]),64&e&&(S.value=t[6])},i:e,o:e,d(e){e&&$(n),N&&N.d(),t[19](null),A=!1,o(R)}}}let at="dynamic-video-widget";function ut(t,e,n){let r,i,o,l,{name:a}=e,{value:u}=e,{urlPrefix:s}=e,c="",d="",f="",p=!1;u&&(d=u?.url||"",c=u?.poster||"");return t.$$set=t=>{"name"in t&&n(0,a=t.name),"value"in t&&n(13,u=t.value),"urlPrefix"in t&&n(14,s=t.urlPrefix)},t.$$.update=()=>{16386&t.$$.dirty&&n(8,r=c.startsWith("http")||c.startsWith("//")?c:s+c),6&t.$$.dirty&&n(6,f=d?JSON.stringify({url:d,poster:c||d.replace(/\.mp4$/,".jpg")}):"null")},[a,c,d,i,o,l,f,p,r,()=>{},()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1});e.callback=t=>{n(1,c=t.replace(s,"")),e.active=!1},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},t=>{const e=window.VIDEO_MANAGER_URL,r=window.VIDEO_MANAGER_KEY,i=new VideoManager({video_manager_url:e,video_manager_key:r});window.addEventListener("message",(function(t){i.eventListener(t)})),i.callback=t=>{console.log(t);let e=t.duration||"00";e=e.split(":").reverse().reduce(((t,e,n)=>t+Number(e)*60**n),0);let r=document.querySelector("#id_duration");r&&(r.value=e);let i="https://video.ambebi.ge/"+t.url.replace("//","/"),o=i+".jpg";n(2,d=i+".mp4"),c||n(1,c=o)},i.open()},async function(){l.pause(),n(7,p=!0);const t=i.parentElement.dataset.frame,e=Math.floor(l.currentTime),r=new FormData;r.append("video-url",d),r.append("seconds",e);const o=await fetch(t,{method:"POST",body:r,headers:{"X-CSRFToken":document.querySelector('meta[name="csrftoken"]').content}}),a=await o.json();n(1,c=a.url);const u=document.querySelector("input#id_image");u&&(u.value=a.url,u.dispatchEvent(new Event("input",{view:window,bubbles:!0,cancelable:!0}))),n(7,p=!1)},u,s,function(){d=this.value,n(2,d)},function(){c=this.value,n(1,c)},function(t){j[t?"unshift":"push"]((()=>{l=t,n(5,l)}))},function(t){j[t?"unshift":"push"]((()=>{o=t,n(4,o)}))},function(t){j[t?"unshift":"push"]((()=>{i=t,n(3,i)}))}]}class st extends Q{constructor(t){super(),H(this,t,ut,lt,a,{name:0,value:13,urlPrefix:14})}}function ct(t){let e,n,r,i;return{c(){e=_("div"),n=_("audio"),s(n.src,r=t[1])||E(n,"src",r),n.controls=!0,E(e,"class",i=ft+"-container")},m(r,i){y(r,e,i),h(e,n),t[8](n)},p(t,e){2&e&&!s(n.src,r=t[1])&&E(n,"src",r)},d(n){n&&$(e),t[8](null)}}}function dt(t){let n,r,i,l,a,u,s,c,d,f,p,m=t[1]&&ct(t);return{c(){n=_("div"),r=_("div"),i=_("input"),a=x(),u=_("input"),s=x(),m&&m.c(),c=x(),d=_("textarea"),E(i,"class",ft+"-inp"),E(i,"type","text"),E(i,"id",l="id_"+t[0]),E(u,"class",ft+"-btn"),E(u,"type","button"),u.value="არჩევა",E(r,"class",ft),d.hidden=!0,E(d,"name",t[0]),d.value=t[4],E(n,"class",ft+"-wrapper")},m(e,o){y(e,n,o),h(n,r),h(r,i),M(i,t[1]),h(r,a),h(r,u),h(n,s),m&&m.m(n,null),h(n,c),h(n,d),t[9](n),f||(p=[b(i,"input",t[7]),b(u,"click",t[5])],f=!0)},p(t,[e]){1&e&&l!==(l="id_"+t[0])&&E(i,"id",l),2&e&&i.value!==t[1]&&M(i,t[1]),t[1]?m?m.p(t,e):(m=ct(t),m.c(),m.m(n,c)):m&&(m.d(1),m=null),1&e&&E(d,"name",t[0]),16&e&&(d.value=t[4])},i:e,o:e,d(e){e&&$(n),m&&m.d(),t[9](null),f=!1,o(p)}}}let ft="dynamic-video-widget";function pt(t,e,n){let r,i,{name:o}=e,{value:l}=e,a="",u="";l&&(a=l?.url||"");return t.$$set=t=>{"name"in t&&n(0,o=t.name),"value"in t&&n(6,l=t.value)},t.$$.update=()=>{2&t.$$.dirty&&n(4,u=a?JSON.stringify({url:a}):"null")},[o,a,r,i,u,t=>{const e=window.VIDEO_MANAGER_URL+"/audio",r=window.VIDEO_MANAGER_KEY,i=new VideoManager({video_manager_url:e,video_manager_key:r});window.addEventListener("message",(function(t){i.eventListener(t)})),i.callback=t=>{console.log(t);let e=t.duration||"00";e=e.split(":").reverse().reduce(((t,e,n)=>t+Number(e)*60**n),0);let r=document.querySelector("#id_duration");r&&(r.value=e);let i="https://video.ambebi.ge/"+t.url.replace("//","/");n(1,a=i+".mp3")},i.open()},l,function(){a=this.value,n(1,a)},function(t){j[t?"unshift":"push"]((()=>{i=t,n(3,i)}))},function(t){j[t?"unshift":"push"]((()=>{r=t,n(2,r)}))}]}class mt extends Q{constructor(t){super(),H(this,t,pt,dt,a,{name:0,value:6})}}function ht(t){const e=t-1;return e*e*e+1}function vt(t,{from:e,to:n},r={}){const i=getComputedStyle(t),o="none"===i.transform?"":i.transform,[a,u]=i.transformOrigin.split(" ").map(parseFloat),s=e.left+e.width*a/n.width-(n.left+a),c=e.top+e.height*u/n.height-(n.top+u),{delay:d=0,duration:f=(t=>120*Math.sqrt(t)),easing:p=ht}=r;return{delay:d,duration:l(f)?f(Math.sqrt(s*s+c*c)):f,easing:p,css:(t,r)=>{const i=r*s,l=r*c,a=t+r*e.width/n.width,u=t+r*e.height/n.height;return`transform: ${o} translate(${i}px, ${l}px) scale(${a}, ${u});`}}}function gt(t,e,n){const r=t.slice();return r[16]=e[n],r[17]=e,r[18]=n,r}function yt(t,n){let r,i,l,a,u,c,d,f,p,m,v,g,k,S,R,N,O,L,q,C=e;function j(){return n[11](n[18])}function T(){n[12].call(R,n[17],n[18])}function I(...t){return n[13](n[18],...t)}function J(...t){return n[14](n[18],...t)}function G(){return n[15](n[18])}return{key:t,first:null,c(){r=_("div"),i=_("img"),u=x(),c=_("div"),d=x(),f=_("div"),p=_("button"),m=w("×"),v=x(),g=_("input"),S=x(),R=_("textarea"),N=x(),E(i,"class",_t+"-item-img"),s(i.src,l=n[4](n[16].url))||E(i,"src",l),E(i,"alt",a=n[16].title),E(i,"tabindex","-1"),E(c,"class",_t+"-item-overlay"),E(p,"title","წაშლა"),E(p,"type","button"),E(p,"class",_t+"-item-remove"),E(g,"type","text"),g.value=k=n[16].url,g.readOnly=!0,E(f,"class",_t+"-item-controls"),E(r,"class",_t+"-item"),E(r,"draggable","true"),E(r,"ondragover","return false"),A(r,"is-active",n[3]===n[18]),this.first=r},m(t,e){var o;y(t,r,e),h(r,i),h(r,u),h(r,c),h(r,d),h(r,f),h(f,p),h(p,m),h(f,v),h(f,g),h(f,S),h(f,R),M(R,n[16].title),h(r,N),L||(q=[b(p,"click",j),b(R,"input",T),b(r,"dragstart",I),b(r,"drop",(o=J,function(t){return t.preventDefault(),o.call(this,t)})),b(r,"dragenter",G)],L=!0)},p(t,e){n=t,2&e&&!s(i.src,l=n[4](n[16].url))&&E(i,"src",l),2&e&&a!==(a=n[16].title)&&E(i,"alt",a),2&e&&k!==(k=n[16].url)&&g.value!==k&&(g.value=k),2&e&&M(R,n[16].title),10&e&&A(r,"is-active",n[3]===n[18])},r(){O=r.getBoundingClientRect()},f(){D(r),C()},a(){C(),C=P(r,O,vt,{duration:500})},d(t){t&&$(r),L=!1,o(q)}}}function $t(t){let n,r,i,o,l,a,u,s,c,d=[],f=new Map,p=t[1];const m=t=>t[16].url;for(let e=0;e<p.length;e+=1){let n=gt(t,p,e),r=m(n);f.set(r,d[e]=yt(r,n))}return{c(){n=_("div"),r=_("div"),i=_("input"),o=x(),l=_("div");for(let t=0;t<d.length;t+=1)d[t].c();a=x(),u=_("textarea"),E(i,"class",_t+"-btn"),E(i,"type","button"),i.value="არჩევა",E(r,"class",_t+"-control"),E(l,"class",_t+"-items"),E(n,"class",_t+"-wrapper"),u.hidden=!0,E(u,"name",t[0]),u.value=t[2]},m(e,f){y(e,n,f),h(n,r),h(r,i),h(n,o),h(n,l);for(let t=0;t<d.length;t+=1)d[t].m(l,null);y(e,a,f),y(e,u,f),s||(c=b(i,"click",t[5]),s=!0)},p(t,[e]){if(474&e){p=t[1];for(let t=0;t<d.length;t+=1)d[t].r();d=function(t,e,n,r,i,o,l,a,u,s,c,d){let f=t.length,p=o.length,m=f;const h={};for(;m--;)h[t[m].key]=m;const v=[],g=new Map,y=new Map;for(m=p;m--;){const t=d(i,o,m),a=n(t);let u=l.get(a);u?r&&u.p(t,e):(u=s(a,t),u.c()),g.set(a,v[m]=u),a in h&&y.set(a,Math.abs(m-h[a]))}const $=new Set,_=new Set;function w(t){z(t,1),t.m(a,c),l.set(t.key,t),c=t.first,p--}for(;f&&p;){const e=v[p-1],n=t[f-1],r=e.key,i=n.key;e===n?(c=e.first,f--,p--):g.has(i)?!l.has(r)||$.has(r)?w(e):_.has(i)?f--:y.get(r)>y.get(i)?(_.add(r),w(e)):($.add(i),f--):(u(n,l),f--)}for(;f--;){const e=t[f];g.has(e.key)||u(e,l)}for(;p;)w(v[p-1]);return v}(d,e,m,1,t,p,f,l,K,yt,null,gt);for(let t=0;t<d.length;t+=1)d[t].a()}1&e&&E(u,"name",t[0]),4&e&&(u.value=t[2])},i:e,o:e,d(t){t&&$(n);for(let t=0;t<d.length;t+=1)d[t].d();t&&$(a),t&&$(u),s=!1,c()}}}let _t="dynamic-gallery-widget";function wt(t,e,n){let{name:r}=e,{value:i}=e,{urlPrefix:o}=e,l=[],a="";i&&(l=i.map((t=>({...t}))));const u=t=>{const e=l;e.splice(t,1),n(1,l=e)};let s=!1;const c=(t,e)=>{t.dataTransfer.effectAllowed="move",t.dataTransfer.dropEffect="move";const n=e;t.dataTransfer.setData("text/plain",n)},d=(t,e)=>{t.dataTransfer.dropEffect="move";const r=parseInt(t.dataTransfer.getData("text/plain")),i=l;r<e?(i.splice(e+1,0,i[r]),i.splice(r,1)):(i.splice(e,0,i[r]),i.splice(r+1,1)),n(1,l=i),n(3,s=null)};return t.$$set=t=>{"name"in t&&n(0,r=t.name),"value"in t&&n(9,i=t.value),"urlPrefix"in t&&n(10,o=t.urlPrefix)},t.$$.update=()=>{2&t.$$.dirty&&n(2,a=JSON.stringify(l.sort(((t,e)=>t<e?-1:1)).map((t=>({url:t.url,title:t.title})))))},[r,l,a,s,t=>t.startsWith("http")?t:"/media/"+t,()=>{const t=window.MEDIA_MANAGER_URL,e=new MManager({media_manager_url:t,usetinymce:!1,autoclose:!1});e.callback=t=>{let e=t.replace(o,"");if(!!l.find((t=>t.url==e)))return;const r=l;r.splice(0,0,{url:e,title:""}),n(1,l=r)},window.addEventListener("message",(function(t){e.eventListener(t)})),e.active=!0,e.open()},u,c,d,i,o,t=>u(t),function(t,e){t[e].title=this.value,n(1,l)},(t,e)=>c(e,t),(t,e)=>d(e,t),t=>n(3,s=t)]}class xt extends Q{constructor(t){super(),H(this,t,wt,$t,a,{name:0,value:9,urlPrefix:10})}}const bt={image:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new rt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},video:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new st({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})},audio:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new mt({target:t,props:{name:n,value:i}})},gallery:function(t,e={}){const n=e.name,r=t.querySelector(`[name="${n}"]`);let i=function(t){try{return JSON.parse(t.value)}catch(t){return null}}(r);return r.remove(),new xt({target:t,props:{name:n,value:i,urlPrefix:e.url_prefix}})}};return document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll("div[django_widget]").forEach((t=>{const e=t.getAttribute("django_widget");e in bt&&bt[e](t,{...t.dataset,parent:t})}))})),t.mapping=bt,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
>>>>>>> 582c3dc12a9409382079981e07f3d17f362746f3
